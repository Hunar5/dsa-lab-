#include <iostream>
using namespace std;

struct Node {
    int data;
    Node* next;
};
/*Question 1*/
class SLL {
    Node* head;
public:
    SLL() { head = NULL; }

    void insertBegin(int x) {
        Node* temp = new Node{x, head};
        head = temp;
    }

    void insertEnd(int x) {
        Node* temp = new Node{x, NULL};
        if(!head) { head=temp; return; }
        Node* curr=head;
        while(curr->next) curr=curr->next;
        curr->next=temp;
    }

    void insertAfter(int key,int x) {
        Node* curr=head;
        while(curr && curr->data!=key) curr=curr->next;
        if(curr) {
            Node* temp=new Node{x,curr->next};
            curr->next=temp;
        }
    }

    void insertBefore(int key,int x) {
        if(!head) return;
        if(head->data==key) { insertBegin(x); return; }
        Node* curr=head;
        while(curr->next && curr->next->data!=key) curr=curr->next;
        if(curr->next) {
            Node* temp=new Node{x,curr->next};
            curr->next=temp;
        }
    }

    void deleteBegin() {
        if(!head) return;
        Node* temp=head;
        head=head->next;
        delete temp;
    }

    void deleteEnd() {
        if(!head) return;
        if(!head->next) { delete head; head=NULL; return; }
        Node* curr=head;
        while(curr->next->next) curr=curr->next;
        delete curr->next;
        curr->next=NULL;
    }

    void deleteKey(int key) {
        if(!head) return;
        if(head->data==key) { deleteBegin(); return; }
        Node* curr=head;
        while(curr->next && curr->next->data!=key) curr=curr->next;
        if(curr->next) {
            Node* temp=curr->next;
            curr->next=temp->next;
            delete temp;
        }
    }

    void search(int key) {
        Node* curr=head; int pos=1;
        while(curr) {
            if(curr->data==key) { cout<<"Found at position "<<pos<<endl; return; }
            curr=curr->next; pos++;
        }
        cout<<"Not found\n";
    }

    void display() {
        Node* curr=head;
        while(curr) { cout<<curr->data<<"->"; curr=curr->next; }
        cout<<"NULL\n";
    }
};
/*Question 2*/
int countAndDelete(Node*& head,int key) {
    int count=0;
    while(head && head->data==key) {
        Node* temp=head; head=head->next; delete temp; count++;
    }
    Node* curr=head;
    while(curr && curr->next) {
        if(curr->next->data==key) {
            Node* temp=curr->next;
            curr->next=temp->next;
            delete temp; count++;
        } else curr=curr->next;
    }
    return count;
}
/*Question 3*/
Node* findMiddle(Node* head) {
    Node* slow=head; Node* fast=head;
    while(fast && fast->next) {
        slow=slow->next;
        fast=fast->next->next;
    }
    return slow;
}
/*Question 4*/
Node* reverse(Node* head) {
    Node* prev=NULL; Node* curr=head;
    while(curr) {
        Node* next=curr->next;
        curr->next=prev;
        prev=curr;
        curr=next;
    }
    return prev;
}

int main() {
    SLL list;
    int choice,val,key;
    do {
        cout<<"\n1.InsertBegin 2.InsertEnd 3.InsertAfter 4.InsertBefore\n";
        cout<<"5.DeleteBegin 6.DeleteEnd 7.DeleteKey 8.Search 9.Display 10.Exit\n";
        cin>>choice;
        switch(choice) {
            case 1: cin>>val; list.insertBegin(val); break;
            case 2: cin>>val; list.insertEnd(val); break;
            case 3: cin>>key>>val; list.insertAfter(key,val); break;
            case 4: cin>>key>>val; list.insertBefore(key,val); break;
            case 5: list.deleteBegin(); break;
            case 6: list.deleteEnd(); break;
            case 7: cin>>key; list.deleteKey(key); break;
            case 8: cin>>key; list.search(key); break;
            case 9: list.display(); break;
        }
    } while(choice!=10);
}
