#include <iostream>
#include <stack>
#include <queue>
#define MAX 100
using namespace std;

class Stack {
    int arr[MAX];
    int top;
public:
    Stack() { top = -1; }

    void push(int x) {
        if (top == MAX-1) cout << "Stack Overflow\n";
        else arr[++top] = x;
    }

    void pop() {
        if (top == -1) cout << "Stack Underflow\n";
        else cout << "Popped: " << arr[top--] << endl;
    }

    bool isEmpty() { return top == -1; }
    bool isFull() { return top == MAX-1; }

    void peek() {
        if (top == -1) cout << "Empty stack\n";
        else cout << "Top element: " << arr[top] << endl;
    }

    void display() {
        if (top == -1) cout << "Empty stack\n";
        else {
            cout << "Stack: ";
            for (int i=top; i>=0; i--) cout << arr[i] << " ";
            cout << endl;
        }
    }
};
string reverseString(string str) {
    stack<char> s;
    for(char c : str) s.push(c);
    string rev="";
    while(!s.empty()) { rev += s.top(); s.pop(); }
    return rev;
}
bool isBalanced(string exp) {
    stack<char> s;
    for(char c : exp) {
        if(c=='('||c=='{'||c=='[') s.push(c);
        else {
            if(s.empty()) return false;
            char top=s.top(); s.pop();
            if((c==')' && top!='(') || 
               (c=='}' && top!='{') || 
               (c==']' && top!='[')) return false;
        }
    }
    return s.empty();
}
int prec(char c) {
    if(c=='^') return 3;
    if(c=='*'||c=='/') return 2;
    if(c=='+'||c=='-') return 1;
    return -1;
}
string infixToPostfix(string exp) {
    stack<char> s;
    string res="";
    for(char c: exp) {
        if(isalnum(c)) res+=c;
        else if(c=='(') s.push(c);
        else if(c==')') {
            while(!s.empty() && s.top()!='(') {
                res+=s.top(); s.pop();
            }
            s.pop();
        } else {
            while(!s.empty() && prec(s.top())>=prec(c)) {
                res+=s.top(); s.pop();
            }
            s.push(c);
        }
    }
    while(!s.empty()) { res+=s.top(); s.pop(); }
    return res;
}
int evalPostfix(string exp) {
    stack<int> s;
    for(char c: exp) {
        if(isdigit(c)) s.push(c-'0');
        else {
            int val2=s.top(); s.pop();
            int val1=s.top(); s.pop();
            switch(c) {
                case '+': s.push(val1+val2); break;
                case '-': s.push(val1-val2); break;
                case '*': s.push(val1*val2); break;
                case '/': s.push(val1/val2); break;
            }
        }
    }
    return s.top();
}

int main() {
    /*Question 1*/
    Stack s;
    int choice, val;
    do {
        cout << "\n1.Push 2.Pop 3.Peek 4.Display 5.Exit\n";
        cin >> choice;
        switch(choice) {
            case 1: cout << "Enter value: "; cin >> val; s.push(val); break;
            case 2: s.pop(); break;
            case 3: s.peek(); break;
            case 4: s.display(); break;
        }
    } while(choice!=5);
    /*Question 2*/
    string str="DataStructure";
    cout << reverseString(str);
    /*Question 3*/
    string exp="{[()]}";
    cout << (isBalanced(exp) ? "Balanced" : "Not Balanced");
    /*Question 4*/
    string exp="A*(B+C)";
    cout << infixToPostfix(exp);
    /*Question 5*/
    string exp="231*+9-"; // (2+(3*1))-9
    cout << evalPostfix(exp);
    return 0;
}
